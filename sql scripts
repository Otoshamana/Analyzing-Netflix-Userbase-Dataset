-- What is the average monthly revenue generated by each subscription type
SELECT 
    Subscription_Type, 
    ROUND(AVG(Monthly_Revenue),2) AS Average_Monthly_Revenue
FROM 
    netflix_users nu 
GROUP BY 
    Subscription_Type;


-- How does revenue vary by country? Which countries contribute the most to Netflixâ€™s revenue
SELECT 
    Country, 
    SUM(Monthly_Revenue) AS Total_Revenue
FROM 
    netflix_users nu 
GROUP BY 
    Country
ORDER BY 
    Total_Revenue DESC;


-- What is the distribution of users across different subscription types, and how does this impact overall revenue?
SELECT 
    Subscription_Type, 
    COUNT(UserID) AS Number_of_Users, 
    SUM(Monthly_Revenue) AS Total_Revenue
FROM 
    netflix_users nu 
GROUP BY 
    Subscription_Type
ORDER BY 
    Total_Revenue DESC;


-- What devices are most commonly used by Netflix users in different regions
SELECT 
    Country, 
    Device, 
    COUNT(UserID) AS Number_of_Users
FROM 
    netflix_users nu 
GROUP BY 
    Country, 
    Device
ORDER BY 
    Number_of_Users DESC;


-- How does device usage vary among different subscription types
SELECT 
    Subscription_Type, 
    Device, 
    COUNT(UserID) AS Number_of_Users
FROM 
    netflix_users nu 
GROUP BY 
    Subscription_Type, 
    Device
ORDER BY 
    Number_of_Users DESC;


-- What are the most common subscription types in each country?
SELECT 
    Country, 
    Subscription_Type, 
    COUNT(UserID) AS Number_of_Users
FROM 
    netflix_users nu 
GROUP BY 
    Country, 
    Subscription_Type
ORDER BY 
    Number_of_Users DESC;


-- How does the average revenue per user (ARPU) vary across different countries
SELECT 
    Country, 
    ROUND(AVG(Monthly_Revenue),2) AS ARPU
FROM 
    netflix_users nu 
GROUP BY 
    Country
ORDER BY 
    ARPU DESC;


-- What are the defining characteristics of high-revenue customers?
SELECT 
    Subscription_Type, 
    Device, 
    Country, 
    COUNT(UserID) AS Number_of_High_Revenue_Users
FROM 
    netflix_users nu 
WHERE 
    Monthly_Revenue > (SELECT AVG(Monthly_Revenue) FROM netflix_users nu2)
GROUP BY 
    Subscription_Type, 
    Device, 
    Country
ORDER BY 
    Number_of_High_Revenue_Users DESC;

